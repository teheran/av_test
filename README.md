# Задача: Определить какие антивирусы установлены и их статус (Win).
На клиентских (десктопных) версиях Windows информация об установленных антивирусах легко доступна через WMI неймспейс SecurityCenter и SecurityCenter2.
```powershell
Get-WmiObject -Namespace root\SecurityCenter2 -Class AntiVirusProduct
```
В серверных версиях Windows этого WMI неймспейса нет и задача обнаружения антивирусов так просто не решается…
## Попробуем найти универсальное решение...
(FIXME) Предположим, что все антивирусы для защиты файловой системы от зловредной активности используют стандартный механизм, и реализуют фильтры-(мини)драйверы файловой системы ([link](https://docs.microsoft.com/en-us/windows-hardware/drivers/ifs/filter-manager-concepts)). Эти драйверы - суть сервисы, с зависимостью от сервиса FltMgr. (FIXME) Статус (running\stopped) сервиса драйвера соответствует статусу антивируса.

Система разделяет эти драйверы на классы\группы, у каждого класса свое предназначение… Но нам будет интересен класс “FSFilter Anti-Virus”... 
Существует список "зарегистрированных" MS вендоров и их драйверов, [вот](https://docs.microsoft.com/en-us/windows-hardware/drivers/ifs/allocated-altitudes).

Исходя из вышесказанного, не составляет большого труда определить наличие антивирусов от широкого [круга вендоров](https://docs.microsoft.com/en-us/windows-hardware/drivers/ifs/allocated-altitudes#320000---329998-fsfilter-anti-virus). Думается, это решение работает и на десктопе и на сервере. Однако я могу проверить только у себя на десктопе. :smile:

В этом проекте консольный пример реализации описанного алгоритма..
